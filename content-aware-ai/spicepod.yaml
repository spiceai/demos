version: v1beta1
kind: Spicepod
name: content-aware-ai

secrets:
  store: env

datasets:
  # Application data (PostgreSQL)
  - from: s3://spiceai-demo-datasets/taxi_trips/2024/
    name: app_dataset
    description: taxi trips in s3 (federated)

  # Datalake data (S3 queried by Databricks)
  - from: s3://spiceai-demo-datasets/taxi_trips/2024/
    name: datalake_dataset
    description: taxi trips in s3
    results_cache:
      enabled: false
    params:
      file_format: parquet

  # Accelerated Datalake data
  - from: s3://spiceai-demo-datasets/taxi_trips/2024/
    name: accelerated_dataset
    description: taxi trips in s3 (accelerated)
    params:
      file_format: parquet
    acceleration:
      enabled: true

  # File data, indexed using OpenAI embeddings
  - from: s3://spiceai-demo-datasets/cleaned_sales_data.parquet
    name: sales_data_cleaned_embedded
    description: cleaned sales data with embeddings
    acceleration:
      enabled: true
    embeddings:
      - column: address_line1
        use: openai_embeddings

  - from: postgres:syncs
    name: daily_journal
    params:
      pg_host: aws-0-us-west-1.pooler.supabase.com
      pg_db: postgres
      pg_port: 5432
      pg_user: "[supabase_user]"
      pg_pass_key: password
      pg_sslmode: require
    acceleration:
      enabled: true
      refresh_mode: full
      refresh_check_interval: 10s

embeddings:
  - name: openai_embeddings
    from: openai
